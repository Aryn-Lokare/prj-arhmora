from . import ml_models

def predict_chain(findings: list) -> str:
    """
    Analyze list of findings to identify potential exploit chains.
    """
    types = [f.get("type") for f in findings]
    
    # Rule-based reasoning
    has_sqli = any("SQL Injection" in t for t in types)
    has_auth_bypass = any("Authentication Bypass" in t for t in types) # Assuming this type exists or might be found
    has_ssrf = any("Server-Side Request Forgery" in t for t in types)
    has_rce = any("Remote Code Execution" in t for t in types)
    has_lfi = any("Local File Inclusion" in t for t in types)

    # 1. Critical Chains
    if has_sqli and has_auth_bypass:
        return "Possible account takeover via database manipulation."
    
    if has_rce:
        return "Full system compromise possible; remote command execution confirmed."

    if has_sqli:
        return "Data exfiltration or administrative access possible via SQL manipulation."

    if has_ssrf:
        return "Potential internal network exposure or cloud metadata theft."

    if has_lfi:
        return "Sensitive file disclosure (config, passwd) may lead to further compromise."

    # 2. ML likelihood check (informational)
    # likelihood = ml_models.predict_exploit_chain(findings)

    return "No multi-stage exploit chain identified."
